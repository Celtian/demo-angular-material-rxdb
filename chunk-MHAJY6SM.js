import{a as ht,b as bt,c as vt}from"./chunk-CHJWY3VG.js";import{a as at,b as ot,e as nt,f as rt,g as P,i as lt,j as dt,n as st,o as pt,p as mt,q as ct,s as ut,w as ft,x as _t}from"./chunk-P3Z7R4NK.js";import{a as Bt,b as kt,c as Ot,d as Vt,e as Rt}from"./chunk-DHPQRMEE.js";import{a as Pt}from"./chunk-Y4RIFFGC.js";import{a as U}from"./chunk-EAOXID7G.js";import{a as St,b as gt,c as yt}from"./chunk-6XBOG5QA.js";import{C as G,E as Q,F as j,H as W,K as J,L as K,Q as $,R as tt,S as et,T as it,c as E,e as A,sa as xt,ua as Ct}from"./chunk-FDUMOS2Y.js";import{a as Mt,b as Et,c as wt,d as Tt,e as It,f as Dt}from"./chunk-BFBZGNIA.js";import{$b as a,$c as X,Db as S,Fb as g,Hb as c,Lb as R,M as I,Mb as F,Na as i,Nb as N,P as D,Sb as w,Ub as d,Vb as f,W as B,Wb as y,Yc as q,Za as O,Zb as T,Zc as H,_b as z,ac as o,ad as Y,bd as Z,db as V,ga as p,la as b,ma as v,mc as L,nb as C,ob as _,pb as x,ra as k,tb as m,ub as n,vb as l,wb as h}from"./chunk-CGPOFAB2.js";var Ft=e=>[e],Nt=(e,u)=>[e,u];function zt(e,u){if(e&1){let t=S();n(0,"div",2)(1,"button",12),g("deleted",function(){b(t);let r=c(2);return v(r.onDeleted())}),d(2),a(3,"translate"),l()()}if(e&2){let t=c(2);i(),m("appPostDelete",t.dataSource.data().id),i(),y(" ",o(3,2,"uni.delete")," ")}}function Lt(e,u){if(e&1){let t=S();n(0,"button",13),a(1,"translate"),a(2,"translate"),g("click",function(){b(t);let r=c(2);return r.form.controls.title.setValue(""),v(r.form.controls.body.markAsDirty())}),n(3,"mat-icon"),d(4,"close"),l()()}e&2&&(m("matTooltip",o(1,2,"uni.clear")),C("aria-label",o(2,4,"uni.clear")))}function At(e,u){if(e&1){let t=S();n(0,"button",13),a(1,"translate"),a(2,"translate"),g("click",function(){b(t);let r=c(2);return r.form.controls.body.setValue(""),v(r.form.controls.body.markAsDirty())}),n(3,"mat-icon"),d(4,"close"),l()()}e&2&&(m("matTooltip",o(1,2,"uni.clear")),C("aria-label",o(2,4,"uni.clear")))}function Ut(e,u){if(e&1){let t=S();_(0,zt,4,4,"div",2),n(1,"mat-card")(2,"mat-card-header")(3,"mat-card-subtitle"),d(4),l(),n(5,"mat-card-title"),d(6),l()(),n(7,"mat-card-content",3)(8,"form",4),g("ngSubmit",function(){b(t);let r=c();return v(r.onSubmit())})("reset",function(r){b(t);let M=c();return v(M.onReset(r))}),n(9,"mat-form-field",5)(10,"mat-label"),d(11),a(12,"translate"),l(),h(13,"input",6),_(14,Lt,5,6,"button",7),l(),n(15,"mat-form-field",5)(16,"mat-label"),d(17),a(18,"translate"),l(),h(19,"textarea",8,0),a(21,"translate"),_(22,At,5,6,"button",7),l(),n(23,"div",9)(24,"button",10),d(25),a(26,"translate"),l(),n(27,"button",11),d(28),a(29,"translate"),l()()()()()}if(e&2){let t=c();x(t.dataSource.state()==="data"?0:-1),i(3),w("blur-sm",t.dataSource.state()!=="data"),i(),f("#"+t.dataSource.data().id),i(),w("blur-sm",t.dataSource.state()!=="data"),i(),f(t.dataSource.data().title),i(2),m("formGroup",t.form),i(3),f(o(12,17,"form.post.title.label")),i(3),x(t.form.controls.title.value?14:-1),i(3),f(o(18,19,"form.post.body.label")),i(2),m("placeholder",o(21,21,"form.post.body.placeholder")),i(3),x(t.form.controls.body.value?22:-1),i(2),m("disabled",t.form.pristine),i(),y(" ",o(26,23,"uni.reset")," "),i(2),m("disabled",t.form.pristine||t.form.invalid),i(),y(" ",o(29,25,"uni.submit")," ")}}function Gt(e,u){if(e&1&&(n(0,"mat-card")(1,"mat-card-content",14),h(2,"mat-icon",15),a(3,"translate"),n(4,"div"),d(5),l()()()),e&2){let t=c();i(2),C("aria-label",o(3,2,"uni.aria-label.error-icon")),i(3),f(t.dataSource.error())}}function Qt(e,u){e&1&&(n(0,"mat-card")(1,"mat-card-content",14),h(2,"mat-icon",16),a(3,"translate"),n(4,"div"),d(5),a(6,"translate"),l()()()),e&2&&(i(2),C("aria-label",o(3,2,"uni.aria-label.warning-icon")),i(3),f(o(6,4,"error.post-was-not-found")))}function jt(e,u){if(e&1&&(h(0,"mat-icon",19),a(1,"translate"),n(2,"a",18),a(3,"localize"),d(4),l(),h(5,"mat-icon",19),a(6,"translate"),n(7,"a",18),a(8,"localize"),d(9),a(10,"translate"),l()),e&2){let t=c(2);C("aria-label",o(1,6,"uni.aria-label.arrow-icon")),i(2),m("routerLink",z(16,Nt,o(3,8,"/"),t.dataSource.data().id)),i(2),f(t.dataSource.data().id),i(),C("aria-label",o(6,10,"uni.aria-label.arrow-icon")),i(2),m("routerLink",T(19,Ft,o(8,12,"/"+t.dataSource.data().id+"/"+t.ROUTE_DEFINITION.POSTS.EDIT))),i(2),y(" ",o(10,14,"breadcrumbs.posts.edit"))}}function qt(e,u){if(e&1&&(n(0,"div",17)(1,"a",18),a(2,"localize"),d(3),a(4,"translate"),l(),_(5,jt,11,21),l()),e&2){let t=c();i(),m("routerLink",T(7,Ft,o(2,3,"/"))),i(2),f(o(4,5,"breadcrumbs.app.posts")),i(2),x(t.dataSource.state()==="data"?5:-1)}}var Be=(()=>{class e{constructor(){this.breadcrumbsPortalService=p(it),this.route=p(W),this.translate=p(X),this.lr=p($),this.cdr=p(L),this.fb=p(ct),this.apiService=p(St),this.confirm=p(yt),this.router=p(J),this.snackBar=p(xt),this.destroyRef=p(k),this.dataSource=new Bt(kt),this.ROUTE_DEFINITION=Ct,this.form=this.fb.nonNullable.group({title:["",[P.required,P.min(3)]],body:["",[P.required,P.min(3)]]})}canDeactivate(){return this.form.pristine||this.confirm.openCustomConfirmDialog(gt.UnsavedWork)}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent),setTimeout(()=>this.cdr.markForCheck()),this.route.paramMap.pipe(I(500),Vt(),Rt(this.dataSource),Ot(),B(t=>this.apiService.detail(t)),U(this.destroyRef)).subscribe({next:t=>{this.dataSource.setData(t),this.form.patchValue(t)},error:()=>{let t=this.translate.instant("error.unexpected-exception");this.dataSource.setError(t)}})}ngOnDestroy(){this.portalContent?.detach()}onSubmit(){this.apiService.patch(this.dataSource.data().id,this.form.value).pipe(D()).subscribe({next:t=>{this.dataSource.setData(t),this.form.reset(t),this.snackBar.open(this.translate.instant("response.update.success"),this.translate.instant("uni.close"))},error:t=>{console.log(t),this.snackBar.open(this.translate.instant("response.update.failed"),this.translate.instant("uni.close"))}})}onReset(t){t.preventDefault(),this.form.reset(this.dataSource.data())}onDeleted(){let t=this.lr.translateRoute("/");this.router.navigate([t])}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275cmp=O({type:e,selectors:[["app-post-edit"]],viewQuery:function(s,r){if(s&1&&R(E,7),s&2){let M;F(M=N())&&(r.portalContent=M.first)}},decls:4,vars:3,consts:[["autosize","cdkTextareaAutosize"],["class","container flex items-center gap-1 py-4",4,"cdkPortal"],[1,"flex","items-end","justify-end","gap-2"],[1,"flex","flex-col","gap-2","mt-2","text-center"],[3,"ngSubmit","reset","formGroup"],[1,"w-full"],["matInput","","type","text","formControlName","title"],["matSuffix","","mat-icon-button","",3,"matTooltip"],["matInput","","cdkTextareaAutosize","","formControlName","body",3,"placeholder"],[1,"flex","justify-center","gap-2"],["mat-button","","color","primary","type","reset",3,"disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["mat-button","","color","accent",3,"deleted","appPostDelete"],["matSuffix","","mat-icon-button","",3,"click","matTooltip"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","fontIcon","error"],["aria-hidden","false","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["mat-button","","color","primary",3,"routerLink"],["aria-hidden","false","fontIcon","chevron_right"]],template:function(s,r){s&1&&(_(0,Ut,30,27),_(1,Gt,6,4,"mat-card"),_(2,Qt,7,6,"mat-card"),V(3,qt,6,9,"div",1)),s&2&&(x(r.dataSource.state()==="loading"||r.dataSource.state()==="data"?0:-1),i(),x(r.dataSource.state()==="error"?1:-1),i(),x(r.dataSource.state()==="empty"?2:-1))},dependencies:[K,et,ut,st,rt,lt,dt,mt,pt,H,q,j,Q,G,Dt,Mt,wt,It,Tt,Et,_t,ft,vt,bt,nt,at,ot,ht,Z,A,E,Pt,tt,Y],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media(min-width:640px){[_nghost-%COMP%]{max-width:640px}}@media(min-width:768px){[_nghost-%COMP%]{max-width:768px}}@media(min-width:1024px){[_nghost-%COMP%]{max-width:1024px}}@media(min-width:1280px){[_nghost-%COMP%]{max-width:1280px}}@media(min-width:1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0})}}return e})();export{Be as PostEditComponent};
