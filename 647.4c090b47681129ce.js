"use strict";(self.webpackChunkdemo_angular_material_rxdb=self.webpackChunkdemo_angular_material_rxdb||[]).push([[647],{2647:(Z,U,n)=>{n.r(U),n.d(U,{PostDetailComponent:()=>w});var h=n(8484),v=n(6814),t=n(5879),I=n(1993),E=n(2296),p=n(5195),O=n(617),P=n(2787),u=n(3694),D=n(9949),S=n(7398),o=n(2181),f=n(4664),i=n(9397),_=n(5177),C=n(1374),L=n(3003),e=n(4097),r=n(7919),s=n(4852),d=n(5991),m=n(4310),A=n(6241),T=n(8807),R=n(2939);const M=function(c){return[c]};function y(c,x){if(1&c){const a=t.EpF();t.TgZ(0,"div",4)(1,"button",5),t.NdJ("click",function(){t.CHM(a);const g=t.oxw(2);return t.KtG(g.onDelete())}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"a",6),t.ALo(5,"localize"),t._uU(6),t.ALo(7,"translate"),t.qZA()()}if(2&c){const a=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"UNI.delete")),t.xp6(2),t.Q6J("routerLink",t.VKq(9,M,t.lcZ(5,5,"/"+a.dataSource().data.id+"/"+a.ROUTE_DEFINITION.POSTS.EDIT))),t.xp6(2),t.Oqu(t.lcZ(7,7,"UNI.edit"))}}function B(c,x){if(1&c&&(t.ynx(0),t.YNc(1,y,8,11,"div",2),t.TgZ(2,"mat-card")(3,"mat-card-header")(4,"mat-card-subtitle"),t._uU(5),t.qZA(),t.TgZ(6,"mat-card-title"),t._uU(7),t.ALo(8,"uppercase"),t.qZA()(),t.TgZ(9,"mat-card-content")(10,"p",3),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"p"),t._uU(14),t.qZA()()(),t.BQk()),2&c){const a=t.oxw();t.xp6(1),t.Q6J("ngIf","data"===a.dataSource().state),t.xp6(3),t.ekj("blur-sm","loading"===a.dataSource().state),t.xp6(1),t.Oqu("#"+a.dataSource().data.id),t.xp6(1),t.ekj("blur-sm","loading"===a.dataSource().state),t.xp6(1),t.Oqu(t.lcZ(8,13,a.dataSource().data.title)),t.xp6(3),t.ekj("blur-sm","loading"===a.dataSource().state),t.xp6(1),t.hij(" ",t.lcZ(12,15,"post-detail.about-post")," "),t.xp6(2),t.ekj("blur-sm","loading"===a.dataSource().state),t.xp6(1),t.hij(" ",a.dataSource().data.body," ")}}function W(c,x){if(1&c&&(t.ynx(0),t.TgZ(1,"mat-card")(2,"mat-card-content",7),t._UZ(3,"mat-icon",8),t.TgZ(4,"div"),t._uU(5),t.qZA()()(),t.BQk()),2&c){const a=t.oxw();t.xp6(5),t.Oqu(a.dataSource().error)}}function K(c,x){1&c&&(t.ynx(0),t.TgZ(1,"mat-card")(2,"mat-card-content",7),t._UZ(3,"mat-icon",9),t.TgZ(4,"div"),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.BQk()),2&c&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"ERROR.post-was-not-found")))}const Y=function(c,x){return[c,x]};function N(c,x){if(1&c&&(t.ynx(0),t._UZ(1,"mat-icon",11),t.TgZ(2,"a",6),t.ALo(3,"localize"),t._uU(4),t.qZA(),t.BQk()),2&c){const a=t.oxw(2);t.xp6(2),t.Q6J("routerLink",t.WLB(4,Y,t.lcZ(3,2,"/"),a.dataSource().data.id)),t.xp6(2),t.Oqu(a.dataSource().data.id)}}function j(c,x){if(1&c&&(t.TgZ(0,"div",10)(1,"a",6),t.ALo(2,"localize"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,N,5,7,"ng-container",0),t.qZA()),2&c){const a=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(7,M,t.lcZ(2,3,"/"))),t.xp6(2),t.Oqu(t.lcZ(4,5,"BREADCRUMBS.app.posts")),t.xp6(2),t.Q6J("ngIf","data"===a.dataSource().state)}}let w=(()=>{class c{constructor(a,l,g,Q,b,F,z,J,$,G,H){this.breadcrumbsPortalService=a,this.route=l,this.cdr=g,this.language=Q,this.seoService=b,this.translate=F,this.lr=z,this.apiService=J,this.snackBar=$,this.router=G,this.confirm=H,this.destroyRef=(0,t.f3M)(t.ktI),this.dataSource=(0,t.tdS)(new L.o(e.X)),this.ROUTE_DEFINITION=r.R}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent),setTimeout(()=>this.cdr.markForCheck());const a=this.route.paramMap.pipe((0,S.U)(l=>l.get("id")));a.pipe((0,o.h)(l=>!Number.isNaN(Number(l))),(0,f.w)(l=>this.language.language$.pipe((0,i.b)({next:()=>{const g=this.lr.translateRoute(`/${l}`);this.seoService.setSeo({title:this.translate.instant(`SEO.${r.R.POSTS.DETAIL}.title`),description:this.translate.instant(`SEO.${r.R.POSTS.DETAIL}.description`)},g)}}))),(0,I.sL)(this.destroyRef)).subscribe(),a.pipe((0,_.g)(500),(0,i.b)(l=>{("string"!=typeof l||!l)&&this.dataSource.mutate(g=>g.setData(e.X))}),(0,o.h)(l=>"string"==typeof l&&!!l),(0,f.w)(l=>this.apiService.detail(String(l))),(0,I.sL)(this.destroyRef)).subscribe({next:l=>this.dataSource.mutate(g=>g.setData(l)),error:()=>{const l=this.translate.instant("ERROR.unexpected-exception");this.dataSource.mutate(g=>g.setError(l))}})}onDelete(){this.confirm.openCustomConfirmDialog(s.C.Delete).pipe((0,C.P)(),(0,o.h)(a=>!!a),(0,f.w)(()=>this.apiService.delete(this.dataSource().data.id))).subscribe({next:()=>{this.snackBar.open(this.translate.instant("response.delete.success"),this.translate.instant("UNI.close"));const a=this.lr.translateRoute("/");this.router.navigate([a])},error:()=>{this.snackBar.open(this.translate.instant("response.delete.failed"),this.translate.instant("UNI.close"))}})}ngOnDestroy(){this.portalContent?.detach()}}return c.\u0275fac=function(a){return new(a||c)(t.Y36(d.H),t.Y36(P.gz),t.Y36(t.sBO),t.Y36(m.T),t.Y36(A.v),t.Y36(D.sK),t.Y36(u.An),t.Y36(T.s),t.Y36(R.ux),t.Y36(P.F0),t.Y36(s.w))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-post-detail"]],viewQuery:function(a,l){if(1&a&&t.Gf(h.ig,7),2&a){let g;t.iGM(g=t.CRH())&&(l.portalContent=g.first)}},standalone:!0,features:[t.jDz],decls:4,vars:3,consts:[[4,"ngIf"],["class","container flex items-center gap-1 py-4",4,"cdkPortal"],["class","flex items-end justify-end gap-2",4,"ngIf"],[1,"mb-2","font-semibold","text-md"],[1,"flex","items-end","justify-end","gap-2"],["mat-button","","color","accent",3,"click"],["mat-button","","color","primary",3,"routerLink"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","aria-label","Error icon","fontIcon","error"],["aria-hidden","false","aria-label","Warning icon","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["aria-hidden","false","aria-label","Arrow icon","fontIcon","chevron_right"]],template:function(a,l){1&a&&(t.YNc(0,B,15,17,"ng-container",0),t.YNc(1,W,6,1,"ng-container",0),t.YNc(2,K,7,3,"ng-container",0),t.YNc(3,j,6,9,"div",1)),2&a&&(t.Q6J("ngIf","data"===l.dataSource().state||"loading"===l.dataSource().state),t.xp6(1),t.Q6J("ngIf","error"===l.dataSource().state),t.xp6(1),t.Q6J("ngIf","empty"===l.dataSource().state))},dependencies:[v.ez,v.O5,v.gd,P.Bz,P.rH,u.fQ,u.lO,h.eL,h.ig,E.ot,E.zs,E.lW,O.Ps,O.Hw,p.QW,p.a8,p.dn,p.dk,p.$j,p.n5,D.aw,D.X$],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0}),c})()},8807:(Z,U,n)=>{n.d(U,{s:()=>L});var h=n(7715),v=n(7398),t=n(2572);const E={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let p;const O=new Uint8Array(16);function P(){if(!p&&(p=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(O)}const u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));const i=function f(e,r,s){if(E.randomUUID&&!r&&!e)return E.randomUUID();const d=(e=e||{}).random||(e.rng||P)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,r){s=s||0;for(let m=0;m<16;++m)r[s+m]=d[m];return r}return function D(e,r=0){return u[e[r+0]]+u[e[r+1]]+u[e[r+2]]+u[e[r+3]]+"-"+u[e[r+4]]+u[e[r+5]]+"-"+u[e[r+6]]+u[e[r+7]]+"-"+u[e[r+8]]+u[e[r+9]]+"-"+u[e[r+10]]+u[e[r+11]]+u[e[r+12]]+u[e[r+13]]+u[e[r+14]]+u[e[r+15]]}(d)};var _=n(5879),C=n(4221);let L=(()=>{class e{constructor(s){this.rxdbProvider=s}get collection(){return this.rxdbProvider.getDatabaseCollection("posts")}create(s){return(0,h.D)(this.collection.insert({id:i(),...s})).pipe((0,v.U)(d=>d._data))}patch(s,d){return(0,h.D)(this.collection.findOne({selector:{id:s}}).update({id:s,...d})).pipe((0,v.U)(m=>({...m._data,...d})))}put(s,d){return(0,h.D)(this.collection.upsert({id:s,...d})).pipe((0,v.U)(m=>({...m._data,...d})))}detail(s){return(0,h.D)(this.collection.findOne({selector:{id:s}}).exec()).pipe((0,v.U)(d=>d._data))}delete(s){return(0,h.D)(this.collection.findOne({selector:{id:s}}).remove()).pipe((0,v.U)(d=>d._data))}list(s=1,d=5,m="id",A="asc",T=""){const R=T?{title:{$regex:new RegExp(T,"i")}}:void 0;return(0,h.D)(this.collection.find({skip:s-1,limit:d,selector:R,sort:[{[m]:A}]}).exec()).pipe((0,v.U)(M=>M.map(y=>y._data)))}count(){return(0,h.D)(this.collection.count().exec())}listAndCount(s=1,d=5,m="id",A="asc",T=""){return(0,t.a)([this.list(s,d,m,A,T),this.count()]).pipe((0,v.U)(([R,M])=>({items:R,totalCount:M})))}}return e.\u0275fac=function(s){return new(s||e)(_.LFG(C.p))},e.\u0275prov=_.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},4852:(Z,U,n)=>{n.d(U,{C:()=>D,w:()=>S});var h=n(1374),v=n(7398),t=n(5879),I=n(6814),E=n(2296),p=n(7700),O=n(9949);let P=(()=>{class o{constructor(i,_){this.data=i,this.dialogRef=_}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(p.WI),t.Y36(p.so))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirm-dialog"]],standalone:!0,features:[t.jDz],decls:11,vars:10,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions","","align","center"],["mat-button","",3,"mat-dialog-close"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(i,_){1&i&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",2)(5,"button",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",4),t._uU(9),t.ALo(10,"translate"),t.qZA()()),2&i&&(t.xp6(1),t.Oqu(_.data.title),t.xp6(2),t.Oqu(_.data.content),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.Oqu(t.lcZ(7,6,"UNI.no")),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.Oqu(t.lcZ(10,8,"UNI.yes")))},dependencies:[I.ez,p.Is,p.ZT,p.uh,p.xY,p.H8,E.ot,E.lW,O.aw,O.X$],changeDetection:0}),o})(),u=(()=>{class o{constructor(i){this.dialog=i}open(i,_){return this.dialog.open(P,{width:"sm",data:{title:i,content:_}}).afterClosed()}}return o.\u0275fac=function(i){return new(i||o)(t.LFG(p.uw))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var D=function(o){return o[o.Delete=0]="Delete",o[o.UnsavedWork=1]="UnsavedWork",o}(D||{});let S=(()=>{class o{constructor(i,_){this.confirm=i,this.translate=_}openCustomConfirmDialog(i){const _=this.getTitle(i),C=this.getContent(i);return this.open(_,C)}getTitle(i){switch(i){case D.Delete:return this.translate.instant("custom-confirm-dialog.delete-post.title");case D.UnsavedWork:return this.translate.instant("custom-confirm-dialog.unsaved-work.title");default:return this.translate.instant("custom-confirm-dialog.default.title")}}getContent(i){switch(i){case D.Delete:return this.translate.instant("custom-confirm-dialog.delete-post.content");case D.UnsavedWork:return this.translate.instant("custom-confirm-dialog.unsaved-work.content");default:return this.translate.instant("custom-confirm-dialog.default.content")}}open(i,_){return this.confirm.open(i,_).pipe((0,h.P)(),(0,v.U)(C=>!!C))}}return o.\u0275fac=function(i){return new(i||o)(t.LFG(u),t.LFG(O.sK))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}}]);