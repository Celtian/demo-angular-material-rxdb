"use strict";(self.webpackChunkdemo_angular_material_rxdb=self.webpackChunkdemo_angular_material_rxdb||[]).push([[647],{2647:(B,U,n)=>{n.r(U),n.d(U,{PostDetailComponent:()=>Q});var h=n(8484),v=n(6814),t=n(5879),C=n(1993),f=n(2296),_=n(5195),E=n(617),O=n(2787),u=n(3694),x=n(9515),L=n(7398),i=n(2181),I=n(4664),d=n(9397),p=n(5177),D=n(1374),Z=n(3003),a=n(4097),s=n(7919),r=n(4852),c=n(5991),g=n(4310),A=n(6241),T=n(8807),R=n(2939);const M=function(l){return[l]};function S(l,P){if(1&l){const e=t.EpF();t.TgZ(0,"div",4)(1,"button",5),t.NdJ("click",function(){t.CHM(e);const m=t.oxw(2);return t.KtG(m.onDelete())}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"a",6),t.ALo(5,"localize"),t._uU(6),t.ALo(7,"translate"),t.qZA()()}if(2&l){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"UNI.delete")),t.xp6(2),t.Q6J("routerLink",t.VKq(9,M,t.lcZ(5,5,"/"+e.dataSource().data.id+"/"+e.ROUTE_DEFINITION.POSTS.EDIT))),t.xp6(2),t.Oqu(t.lcZ(7,7,"UNI.edit"))}}function W(l,P){if(1&l&&(t.ynx(0),t.YNc(1,S,8,11,"div",2),t.TgZ(2,"mat-card")(3,"mat-card-header")(4,"mat-card-subtitle"),t._uU(5),t.qZA(),t.TgZ(6,"mat-card-title"),t._uU(7),t.ALo(8,"uppercase"),t.qZA()(),t.TgZ(9,"mat-card-content")(10,"p",3),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"p"),t._uU(14),t.qZA()()(),t.BQk()),2&l){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","data"===e.dataSource().state),t.xp6(3),t.ekj("blur-sm","loading"===e.dataSource().state),t.xp6(1),t.Oqu("#"+e.dataSource().data.id),t.xp6(1),t.ekj("blur-sm","loading"===e.dataSource().state),t.xp6(1),t.Oqu(t.lcZ(8,13,e.dataSource().data.title)),t.xp6(3),t.ekj("blur-sm","loading"===e.dataSource().state),t.xp6(1),t.hij(" ",t.lcZ(12,15,"post-detail.about-post")," "),t.xp6(2),t.ekj("blur-sm","loading"===e.dataSource().state),t.xp6(1),t.hij(" ",e.dataSource().data.body," ")}}function K(l,P){if(1&l&&(t.ynx(0),t.TgZ(1,"mat-card")(2,"mat-card-content",7),t._UZ(3,"mat-icon",8),t.TgZ(4,"div"),t._uU(5),t.qZA()()(),t.BQk()),2&l){const e=t.oxw();t.xp6(5),t.Oqu(e.dataSource().error)}}function Y(l,P){1&l&&(t.ynx(0),t.TgZ(1,"mat-card")(2,"mat-card-content",7),t._UZ(3,"mat-icon",9),t.TgZ(4,"div"),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.BQk()),2&l&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"ERROR.post-was-not-found")))}const N=function(l,P){return[l,P]};function j(l,P){if(1&l&&(t.ynx(0),t._UZ(1,"mat-icon",11),t.TgZ(2,"a",6),t.ALo(3,"localize"),t._uU(4),t.qZA(),t.BQk()),2&l){const e=t.oxw(2);t.xp6(2),t.Q6J("routerLink",t.WLB(4,N,t.lcZ(3,2,"/"),e.dataSource().data.id)),t.xp6(2),t.Oqu(e.dataSource().data.id)}}function w(l,P){if(1&l&&(t.TgZ(0,"div",10)(1,"a",6),t.ALo(2,"localize"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,j,5,7,"ng-container",0),t.qZA()),2&l){const e=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(7,M,t.lcZ(2,3,"/"))),t.xp6(2),t.Oqu(t.lcZ(4,5,"BREADCRUMBS.app.posts")),t.xp6(2),t.Q6J("ngIf","data"===e.dataSource().state)}}let Q=(()=>{class l{constructor(e,o,m,y,b,F,z,J,$,G,H){this.breadcrumbsPortalService=e,this.route=o,this.cdr=m,this.language=y,this.seoService=b,this.translate=F,this.lr=z,this.apiService=J,this.snackBar=$,this.router=G,this.confirm=H,this.destroyRef=(0,t.f3M)(t.ktI),this.dataSource=(0,t.tdS)(new Z.o(a.X)),this.ROUTE_DEFINITION=s.R}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent),setTimeout(()=>this.cdr.markForCheck());const e=this.route.paramMap.pipe((0,L.U)(o=>o.get("id")));e.pipe((0,i.h)(o=>!Number.isNaN(Number(o))),(0,I.w)(o=>this.language.language$.pipe((0,d.b)({next:()=>{const m=this.lr.translateRoute(`/${o}`);this.seoService.setSeo({title:this.translate.instant(`SEO.${s.R.POSTS.DETAIL}.title`),description:this.translate.instant(`SEO.${s.R.POSTS.DETAIL}.description`)},m)}}))),(0,C.sL)(this.destroyRef)).subscribe(),e.pipe((0,p.g)(500),(0,d.b)(o=>{("string"!=typeof o||!o)&&this.dataSource.mutate(m=>m.setData(a.X))}),(0,i.h)(o=>"string"==typeof o&&!!o),(0,I.w)(o=>this.apiService.detail(String(o))),(0,C.sL)(this.destroyRef)).subscribe({next:o=>this.dataSource.mutate(m=>m.setData(o)),error:()=>{const o=this.translate.instant("ERROR.unexpected-exception");this.dataSource.mutate(m=>m.setError(o))}})}onDelete(){this.confirm.openCustomConfirmDialog(r.C.Delete).pipe((0,D.P)(),(0,i.h)(e=>!!e),(0,I.w)(()=>this.apiService.delete(this.dataSource().data.id))).subscribe({next:()=>{this.snackBar.open(this.translate.instant("response.delete.success"),this.translate.instant("UNI.close"));const e=this.lr.translateRoute("/");this.router.navigate([e])},error:()=>{this.snackBar.open(this.translate.instant("response.delete.failed"),this.translate.instant("UNI.close"))}})}ngOnDestroy(){this.portalContent?.detach()}static#t=this.\u0275fac=function(o){return new(o||l)(t.Y36(c.H),t.Y36(O.gz),t.Y36(t.sBO),t.Y36(g.T),t.Y36(A.v),t.Y36(x.sK),t.Y36(u.An),t.Y36(T.s),t.Y36(R.ux),t.Y36(O.F0),t.Y36(r.w))};static#n=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-post-detail"]],viewQuery:function(o,m){if(1&o&&t.Gf(h.ig,7),2&o){let y;t.iGM(y=t.CRH())&&(m.portalContent=y.first)}},standalone:!0,features:[t.jDz],decls:4,vars:3,consts:[[4,"ngIf"],["class","container flex items-center gap-1 py-4",4,"cdkPortal"],["class","flex items-end justify-end gap-2",4,"ngIf"],[1,"mb-2","font-semibold","text-md"],[1,"flex","items-end","justify-end","gap-2"],["mat-button","","color","accent",3,"click"],["mat-button","","color","primary",3,"routerLink"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","aria-label","Error icon","fontIcon","error"],["aria-hidden","false","aria-label","Warning icon","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["aria-hidden","false","aria-label","Arrow icon","fontIcon","chevron_right"]],template:function(o,m){1&o&&(t.YNc(0,W,15,17,"ng-container",0),t.YNc(1,K,6,1,"ng-container",0),t.YNc(2,Y,7,3,"ng-container",0),t.YNc(3,w,6,9,"div",1)),2&o&&(t.Q6J("ngIf","data"===m.dataSource().state||"loading"===m.dataSource().state),t.xp6(1),t.Q6J("ngIf","error"===m.dataSource().state),t.xp6(1),t.Q6J("ngIf","empty"===m.dataSource().state))},dependencies:[v.ez,v.O5,v.gd,O.Bz,O.rH,u.fQ,u.lO,h.eL,h.ig,f.ot,f.zs,f.lW,E.Ps,E.Hw,_.QW,_.a8,_.dn,_.dk,_.$j,_.n5,x.aw,x.X$],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0})}return l})()},8807:(B,U,n)=>{n.d(U,{s:()=>Z});var h=n(7715),v=n(7398),t=n(2572);const f={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let _;const E=new Uint8Array(16);function O(){if(!_&&(_=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!_))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _(E)}const u=[];for(let a=0;a<256;++a)u.push((a+256).toString(16).slice(1));const d=function I(a,s,r){if(f.randomUUID&&!s&&!a)return f.randomUUID();const c=(a=a||{}).random||(a.rng||O)();if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,s){r=r||0;for(let g=0;g<16;++g)s[r+g]=c[g];return s}return function x(a,s=0){return u[a[s+0]]+u[a[s+1]]+u[a[s+2]]+u[a[s+3]]+"-"+u[a[s+4]]+u[a[s+5]]+"-"+u[a[s+6]]+u[a[s+7]]+"-"+u[a[s+8]]+u[a[s+9]]+"-"+u[a[s+10]]+u[a[s+11]]+u[a[s+12]]+u[a[s+13]]+u[a[s+14]]+u[a[s+15]]}(c)};var p=n(5879),D=n(574);let Z=(()=>{class a{constructor(r){this.rxdbProvider=r}get collection(){return this.rxdbProvider.getDatabaseCollection("posts")}create(r){return(0,h.D)(this.collection.insert({id:d(),...r})).pipe((0,v.U)(c=>c._data))}patch(r,c){return(0,h.D)(this.collection.findOne({selector:{id:r}}).update({id:r,...c})).pipe((0,v.U)(g=>({...g._data,...c})))}put(r,c){return(0,h.D)(this.collection.upsert({id:r,...c})).pipe((0,v.U)(g=>({...g._data,...c})))}detail(r){return(0,h.D)(this.collection.findOne({selector:{id:r}}).exec()).pipe((0,v.U)(c=>c._data))}delete(r){return(0,h.D)(this.collection.findOne({selector:{id:r}}).remove()).pipe((0,v.U)(c=>c._data))}list(r=1,c=5,g="id",A="asc",T=""){const R=T?{title:{$regex:new RegExp(T,"i")}}:void 0;return(0,h.D)(this.collection.find({skip:r-1,limit:c,selector:R,sort:[{[g]:A}]}).exec()).pipe((0,v.U)(M=>M.map(S=>S._data)))}count(){return(0,h.D)(this.collection.count().exec())}listAndCount(r=1,c=5,g="id",A="asc",T=""){return(0,t.a)([this.list(r,c,g,A,T),this.count()]).pipe((0,v.U)(([R,M])=>({items:R,totalCount:M})))}static#t=this.\u0275fac=function(c){return new(c||a)(p.LFG(D.p))};static#n=this.\u0275prov=p.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},4852:(B,U,n)=>{n.d(U,{C:()=>x,w:()=>L});var h=n(1374),v=n(7398),t=n(5879),C=n(6814),f=n(2296),_=n(7700),E=n(9515);let O=(()=>{class i{constructor(d,p){this.data=d,this.dialogRef=p}static#t=this.\u0275fac=function(p){return new(p||i)(t.Y36(_.WI),t.Y36(_.so))};static#n=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-confirm-dialog"]],standalone:!0,features:[t.jDz],decls:11,vars:10,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions","","align","center"],["mat-button","",3,"mat-dialog-close"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(p,D){1&p&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",2)(5,"button",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",4),t._uU(9),t.ALo(10,"translate"),t.qZA()()),2&p&&(t.xp6(1),t.Oqu(D.data.title),t.xp6(2),t.Oqu(D.data.content),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.Oqu(t.lcZ(7,6,"UNI.no")),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.Oqu(t.lcZ(10,8,"UNI.yes")))},dependencies:[C.ez,_.Is,_.ZT,_.uh,_.xY,_.H8,f.ot,f.lW,E.aw,E.X$],changeDetection:0})}return i})(),u=(()=>{class i{constructor(d){this.dialog=d}open(d,p){return this.dialog.open(O,{width:"sm",data:{title:d,content:p}}).afterClosed()}static#t=this.\u0275fac=function(p){return new(p||i)(t.LFG(_.uw))};static#n=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var x=function(i){return i[i.Delete=0]="Delete",i[i.UnsavedWork=1]="UnsavedWork",i}(x||{});let L=(()=>{class i{constructor(d,p){this.confirm=d,this.translate=p}openCustomConfirmDialog(d){const p=this.getTitle(d),D=this.getContent(d);return this.open(p,D)}getTitle(d){switch(d){case x.Delete:return this.translate.instant("custom-confirm-dialog.delete-post.title");case x.UnsavedWork:return this.translate.instant("custom-confirm-dialog.unsaved-work.title");default:return this.translate.instant("custom-confirm-dialog.default.title")}}getContent(d){switch(d){case x.Delete:return this.translate.instant("custom-confirm-dialog.delete-post.content");case x.UnsavedWork:return this.translate.instant("custom-confirm-dialog.unsaved-work.content");default:return this.translate.instant("custom-confirm-dialog.default.content")}}open(d,p){return this.confirm.open(d,p).pipe((0,h.P)(),(0,v.U)(D=>!!D))}static#t=this.\u0275fac=function(p){return new(p||i)(t.LFG(u),t.LFG(E.sK))};static#n=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()}}]);