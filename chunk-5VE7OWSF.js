import{a as bt,b as gt,c as yt}from"./chunk-BIZ7I3BT.js";import{a as rt,b as lt,e as dt,g as st,h as I,j as mt,k as ct,o as pt,p as ut,q as ft,r as _t,t as xt,u as ht,v as Ct}from"./chunk-PP5RWD45.js";import{a as Vt,b as Rt,c as Ft,d as Nt,e as jt}from"./chunk-EL34CJYF.js";import{a as Et}from"./chunk-MHZZEM3Z.js";import{a as G}from"./chunk-OA2XJTGZ.js";import{a as It,b as Mt,c as Pt}from"./chunk-ZBOY7WNZ.js";import{U as vt,W as St,c as P,e as U,f as Q,g as q,h as W,i as H,k as X,n as Y,o as Z,t as it,u as at,v as ot,x as nt}from"./chunk-BY7LDDRT.js";import{a as wt,b as Tt,c as Dt,d as kt,e as Bt,f as Ot}from"./chunk-4P3SKR73.js";import{$a as S,Ab as N,Ad as $,Bb as T,Bd as tt,Cb as j,Cd as et,Db as l,Eb as d,Ib as A,Ja as i,Jb as z,Ka as c,L as D,Lb as L,Ma as R,Na as F,O as k,Ua as E,Va as p,W as B,Xa as w,ab as x,eb as n,fb as r,ga as O,gb as h,ha as V,kb as b,ma as C,na as v,ob as g,qb as u,ub as m,vb as _,wb as y,xd as J,yd as K}from"./chunk-YXJN27LE.js";function Wt(t,s){if(t&1){let e=b();n(0,"div",12)(1,"button",13),g("deleted",function(){C(e);let o=u(2);return v(o.onDeleted())}),m(2),l(3,"translate"),r()()}if(t&2){let e=u(2);i(1),p("appPostDelete",e.dataSource.data().id),i(1),y(" ",d(3,2,"uni.delete")," ")}}function Ht(t,s){if(t&1){let e=b();n(0,"button",14),g("click",function(){C(e);let o=u(2);return o.form.controls.title.setValue(""),v(o.form.controls.body.markAsDirty())}),l(1,"translate"),l(2,"translate"),n(3,"mat-icon"),m(4,"close"),r()()}t&2&&(p("matTooltip",d(2,4,"uni.clear")),E("aria-label",d(1,2,"uni.clear")))}function Jt(t,s){if(t&1){let e=b();n(0,"button",14),g("click",function(){C(e);let o=u(2);return o.form.controls.body.setValue(""),v(o.form.controls.body.markAsDirty())}),l(1,"translate"),l(2,"translate"),n(3,"mat-icon"),m(4,"close"),r()()}t&2&&(p("matTooltip",d(2,4,"uni.clear")),E("aria-label",d(1,2,"uni.clear")))}function Kt(t,s){if(t&1){let e=b();S(0,Wt,4,4,"div",1),n(1,"mat-card")(2,"mat-card-header")(3,"mat-card-subtitle"),m(4),r(),n(5,"mat-card-title"),m(6),r()(),n(7,"mat-card-content",2)(8,"form",3),g("ngSubmit",function(){C(e);let o=u();return v(o.onSubmit())})("reset",function(o){C(e);let f=u();return v(f.onReset(o))}),n(9,"mat-form-field",4)(10,"mat-label"),m(11),l(12,"translate"),r(),h(13,"input",5),S(14,Ht,5,6,"button",6),r(),n(15,"mat-form-field",4)(16,"mat-label"),m(17),l(18,"translate"),r(),h(19,"textarea",7,8),l(21,"translate"),S(22,Jt,5,6,"button",6),r(),n(23,"div",9)(24,"button",10),m(25),l(26,"translate"),r(),n(27,"button",11),m(28),l(29,"translate"),r()()()()()}if(t&2){let e=u();x(0,e.dataSource.state()==="data"?0:-1),i(3),w("blur-sm",e.dataSource.state()!=="data"),i(1),_("#"+e.dataSource.data().id),i(1),w("blur-sm",e.dataSource.state()!=="data"),i(1),_(e.dataSource.data().title),i(2),p("formGroup",e.form),i(3),_(d(12,17,"form.post.title.label")),i(3),x(14,e.form.controls.title.value?14:-1),i(3),_(d(18,19,"form.post.body.label")),i(2),p("placeholder",d(21,21,"form.post.body.placeholder")),i(3),x(22,e.form.controls.body.value?22:-1),i(2),p("disabled",e.form.pristine),i(1),y(" ",d(26,23,"uni.reset")," "),i(2),p("disabled",e.form.pristine||e.form.invalid),i(1),y(" ",d(29,25,"uni.submit")," ")}}function Xt(t,s){if(t&1&&(n(0,"mat-card")(1,"mat-card-content",15),h(2,"mat-icon",16),n(3,"div"),m(4),r()()()),t&2){let e=u();i(4),_(e.dataSource.error())}}function Yt(t,s){t&1&&(n(0,"mat-card")(1,"mat-card-content",15),h(2,"mat-icon",17),n(3,"div"),m(4),l(5,"translate"),r()()()),t&2&&(i(4),_(d(5,1,"error.post-was-not-found")))}var Zt=(t,s)=>[t,s],At=t=>[t];function $t(t,s){if(t&1&&(h(0,"mat-icon",20),n(1,"a",19),l(2,"localize"),m(3),r(),h(4,"mat-icon",20),n(5,"a",19),l(6,"localize"),m(7),l(8,"translate"),r()),t&2){let e=u(2);i(1),p("routerLink",j(10,Zt,d(2,4,"/"),e.dataSource.data().id)),i(2),_(e.dataSource.data().id),i(2),p("routerLink",T(13,At,d(6,6,"/"+e.dataSource.data().id+"/"+e.ROUTE_DEFINITION.POSTS.EDIT))),i(2),y(" ",d(8,8,"breadcrumbs.posts.edit"),"")}}function te(t,s){if(t&1&&(n(0,"div",18)(1,"a",19),l(2,"localize"),m(3),l(4,"translate"),r(),S(5,$t,9,15),r()),t&2){let e=u();i(1),p("routerLink",T(7,At,d(2,3,"/"))),i(2),_(d(4,5,"breadcrumbs.app.posts")),i(2),x(5,e.dataSource.state()==="data"?5:-1)}}var Ue=(()=>{let s=class s{constructor(a,o,f,M,zt,Lt,Ut,Gt,Qt,qt){this.breadcrumbsPortalService=a,this.route=o,this.translate=f,this.lr=M,this.cdr=zt,this.fb=Lt,this.apiService=Ut,this.confirm=Gt,this.router=Qt,this.snackBar=qt,this.destroyRef=O(F),this.dataSource=new Vt(Rt),this.ROUTE_DEFINITION=St,this.form=this.fb.nonNullable.group({title:["",[I.required,I.min(3)]],body:["",[I.required,I.min(3)]]})}canDeactivate(){return this.form.pristine||this.confirm.openCustomConfirmDialog(It.UnsavedWork)}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent),setTimeout(()=>this.cdr.markForCheck()),this.route.paramMap.pipe(D(500),Nt(),jt(this.dataSource),Ft(),B(a=>this.apiService.detail(a)),G(this.destroyRef)).subscribe({next:a=>{this.dataSource.setData(a),this.form.patchValue(a)},error:()=>{let a=this.translate.instant("error.unexpected-exception");this.dataSource.setError(a)}})}ngOnDestroy(){this.portalContent?.detach()}onSubmit(){this.apiService.patch(this.dataSource.data().id,this.form.value).pipe(k()).subscribe({next:a=>{this.dataSource.setData(a),this.form.reset(a),this.snackBar.open(this.translate.instant("response.update.success"),this.translate.instant("uni.close"))},error:a=>{console.log(a),this.snackBar.open(this.translate.instant("response.update.failed"),this.translate.instant("uni.close"))}})}onReset(a){a.preventDefault(),this.form.reset(this.dataSource.data())}onDeleted(){let a=this.lr.translateRoute("/");this.router.navigate([a])}};s.\u0275fac=function(o){return new(o||s)(c(nt),c(X),c($),c(it),c(R),c(_t),c(Pt),c(Mt),c(Y),c(vt))},s.\u0275cmp=V({type:s,selectors:[["app-post-edit"]],viewQuery:function(o,f){if(o&1&&z(P,7),o&2){let M;A(M=L())&&(f.portalContent=M.first)}},standalone:!0,features:[N],decls:4,vars:3,consts:[["class","container flex items-center gap-1 py-4",4,"cdkPortal"],["class","flex items-end justify-end gap-2"],[1,"flex","flex-col","gap-2","mt-2","text-center"],[3,"formGroup","ngSubmit","reset"],[1,"w-full"],["matInput","","type","text","formControlName","title"],["matSuffix","","mat-icon-button","",3,"matTooltip"],["matInput","","cdkTextareaAutosize","","formControlName","body",3,"placeholder"],["autosize","cdkTextareaAutosize"],[1,"flex","justify-center","gap-2"],["mat-button","","color","primary","type","reset",3,"disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"flex","items-end","justify-end","gap-2"],["mat-button","","color","accent",3,"appPostDelete","deleted"],["matSuffix","","mat-icon-button","",3,"matTooltip","click"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","aria-label","Error icon","fontIcon","error"],["aria-hidden","false","aria-label","Warning icon","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["mat-button","","color","primary",3,"routerLink"],["aria-hidden","false","aria-label","Arrow icon","fontIcon","chevron_right"]],template:function(o,f){o&1&&S(0,Kt,30,27,"mat-card")(1,Xt,5,1,"mat-card")(2,Yt,6,3,"mat-card")(3,te,6,9,"div",0),o&2&&(x(0,f.dataSource.state()==="loading"||f.dataSource.state()==="data"?0:-1),i(1),x(1,f.dataSource.state()==="error"?1:-1),i(1),x(2,f.dataSource.state()==="empty"?2:-1))},dependencies:[Z,ot,at,xt,pt,st,mt,ct,ut,ft,K,J,H,q,Q,W,Ot,wt,Dt,Bt,kt,Tt,Ct,ht,yt,gt,dt,rt,lt,bt,et,tt,U,P,Et],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0});let t=s;return t})();export{Ue as PostEditComponent};
