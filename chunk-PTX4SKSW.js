import{a as bt,b as vt,c as St}from"./chunk-IF3IWR4N.js";import{a as ot,b as nt,e as rt,f as lt,g as P,i as dt,j as st,n as pt,o as mt,p as ct,q as ut,s as ft,w as _t,x as xt}from"./chunk-MMPNKEAA.js";import{a as kt,b as Ot,c as Vt,d as Rt,e as Ft}from"./chunk-C2SVJX3G.js";import{a as Pt}from"./chunk-B3DSH7CR.js";import{a as G}from"./chunk-OLALDK7H.js";import{a as gt,b as yt,c as Mt}from"./chunk-XE2BGYEC.js";import{A as it,B as at,_ as Ct,aa as ht,c as w,e as U,k as Q,m as j,n as q,p as J,s as K,t as X,y as tt,z as et}from"./chunk-BKWKYVVQ.js";import{a as wt,b as Et,c as Tt,d as It,e as Dt,f as Bt}from"./chunk-VQTLKLRP.js";import{Bb as y,Db as u,Hb as F,Ia as i,Ib as N,Jb as z,L as D,O as B,Ob as E,Qb as p,Rb as f,Sb as M,Vb as T,W as k,Wa as V,Wb as L,Xb as o,Yb as n,ab as R,ga as m,jb as h,kb as x,kc as A,la as v,lb as C,ma as S,pb as c,qb as r,ra as O,rb as d,rd as H,sb as b,sd as W,ud as Y,vd as Z,wd as $,zb as g}from"./chunk-OASJ4F2E.js";var Nt=t=>[t],zt=(t,s)=>[t,s];function Lt(t,s){if(t&1){let e=g();r(0,"div",2)(1,"button",12),y("deleted",function(){v(e);let l=u(2);return S(l.onDeleted())}),p(2),o(3,"translate"),d()()}if(t&2){let e=u(2);i(),c("appPostDelete",e.dataSource.data().id),i(),M(" ",n(3,2,"uni.delete")," ")}}function At(t,s){if(t&1){let e=g();r(0,"button",13),o(1,"translate"),o(2,"translate"),y("click",function(){v(e);let l=u(2);return l.form.controls.title.setValue(""),S(l.form.controls.body.markAsDirty())}),r(3,"mat-icon"),p(4,"close"),d()()}t&2&&(c("matTooltip",n(1,2,"uni.clear")),h("aria-label",n(2,4,"uni.clear")))}function Ut(t,s){if(t&1){let e=g();r(0,"button",13),o(1,"translate"),o(2,"translate"),y("click",function(){v(e);let l=u(2);return l.form.controls.body.setValue(""),S(l.form.controls.body.markAsDirty())}),r(3,"mat-icon"),p(4,"close"),d()()}t&2&&(c("matTooltip",n(1,2,"uni.clear")),h("aria-label",n(2,4,"uni.clear")))}function Gt(t,s){if(t&1){let e=g();x(0,Lt,4,4,"div",2),r(1,"mat-card")(2,"mat-card-header")(3,"mat-card-subtitle"),p(4),d(),r(5,"mat-card-title"),p(6),d()(),r(7,"mat-card-content",3)(8,"form",4),y("ngSubmit",function(){v(e);let l=u();return S(l.onSubmit())})("reset",function(l){v(e);let _=u();return S(_.onReset(l))}),r(9,"mat-form-field",5)(10,"mat-label"),p(11),o(12,"translate"),d(),b(13,"input",6),x(14,At,5,6,"button",7),d(),r(15,"mat-form-field",5)(16,"mat-label"),p(17),o(18,"translate"),d(),b(19,"textarea",8,0),o(21,"translate"),x(22,Ut,5,6,"button",7),d(),r(23,"div",9)(24,"button",10),p(25),o(26,"translate"),d(),r(27,"button",11),p(28),o(29,"translate"),d()()()()()}if(t&2){let e=u();C(e.dataSource.state()==="data"?0:-1),i(3),E("blur-sm",e.dataSource.state()!=="data"),i(),f("#"+e.dataSource.data().id),i(),E("blur-sm",e.dataSource.state()!=="data"),i(),f(e.dataSource.data().title),i(2),c("formGroup",e.form),i(3),f(n(12,17,"form.post.title.label")),i(3),C(e.form.controls.title.value?14:-1),i(3),f(n(18,19,"form.post.body.label")),i(2),c("placeholder",n(21,21,"form.post.body.placeholder")),i(3),C(e.form.controls.body.value?22:-1),i(2),c("disabled",e.form.pristine),i(),M(" ",n(26,23,"uni.reset")," "),i(2),c("disabled",e.form.pristine||e.form.invalid),i(),M(" ",n(29,25,"uni.submit")," ")}}function Qt(t,s){if(t&1&&(r(0,"mat-card")(1,"mat-card-content",14),b(2,"mat-icon",15),o(3,"translate"),r(4,"div"),p(5),d()()()),t&2){let e=u();i(2),h("aria-label",n(3,2,"uni.aria-label.error-icon")),i(3),f(e.dataSource.error())}}function jt(t,s){t&1&&(r(0,"mat-card")(1,"mat-card-content",14),b(2,"mat-icon",16),o(3,"translate"),r(4,"div"),p(5),o(6,"translate"),d()()()),t&2&&(i(2),h("aria-label",n(3,2,"uni.aria-label.warning-icon")),i(3),f(n(6,4,"error.post-was-not-found")))}function qt(t,s){if(t&1&&(b(0,"mat-icon",19),o(1,"translate"),r(2,"a",18),o(3,"localize"),p(4),d(),b(5,"mat-icon",19),o(6,"translate"),r(7,"a",18),o(8,"localize"),p(9),o(10,"translate"),d()),t&2){let e=u(2);h("aria-label",n(1,6,"uni.aria-label.arrow-icon")),i(2),c("routerLink",L(16,zt,n(3,8,"/"),e.dataSource.data().id)),i(2),f(e.dataSource.data().id),i(),h("aria-label",n(6,10,"uni.aria-label.arrow-icon")),i(2),c("routerLink",T(19,Nt,n(8,12,"/"+e.dataSource.data().id+"/"+e.ROUTE_DEFINITION.POSTS.EDIT))),i(2),M(" ",n(10,14,"breadcrumbs.posts.edit"))}}function Ht(t,s){if(t&1&&(r(0,"div",17)(1,"a",18),o(2,"localize"),p(3),o(4,"translate"),d(),x(5,qt,11,21),d()),t&2){let e=u();i(),c("routerLink",T(7,Nt,n(2,3,"/"))),i(2),f(n(4,5,"breadcrumbs.app.posts")),i(2),C(e.dataSource.state()==="data"?5:-1)}}var ke=(()=>{let s=class s{constructor(){this.breadcrumbsPortalService=m(at),this.route=m(J),this.translate=m(Y),this.lr=m(tt),this.cdr=m(A),this.fb=m(ut),this.apiService=m(gt),this.confirm=m(Mt),this.router=m(K),this.snackBar=m(Ct),this.destroyRef=m(O),this.dataSource=new kt(Ot),this.ROUTE_DEFINITION=ht,this.form=this.fb.nonNullable.group({title:["",[P.required,P.min(3)]],body:["",[P.required,P.min(3)]]})}canDeactivate(){return this.form.pristine||this.confirm.openCustomConfirmDialog(yt.UnsavedWork)}ngOnInit(){this.breadcrumbsPortalService.setPortal(this.portalContent),setTimeout(()=>this.cdr.markForCheck()),this.route.paramMap.pipe(D(500),Rt(),Ft(this.dataSource),Vt(),k(a=>this.apiService.detail(a)),G(this.destroyRef)).subscribe({next:a=>{this.dataSource.setData(a),this.form.patchValue(a)},error:()=>{let a=this.translate.instant("error.unexpected-exception");this.dataSource.setError(a)}})}ngOnDestroy(){this.portalContent?.detach()}onSubmit(){this.apiService.patch(this.dataSource.data().id,this.form.value).pipe(B()).subscribe({next:a=>{this.dataSource.setData(a),this.form.reset(a),this.snackBar.open(this.translate.instant("response.update.success"),this.translate.instant("uni.close"))},error:a=>{console.log(a),this.snackBar.open(this.translate.instant("response.update.failed"),this.translate.instant("uni.close"))}})}onReset(a){a.preventDefault(),this.form.reset(this.dataSource.data())}onDeleted(){let a=this.lr.translateRoute("/");this.router.navigate([a])}};s.\u0275fac=function(l){return new(l||s)},s.\u0275cmp=V({type:s,selectors:[["app-post-edit"]],viewQuery:function(l,_){if(l&1&&F(w,7),l&2){let I;N(I=z())&&(_.portalContent=I.first)}},decls:4,vars:3,consts:[["autosize","cdkTextareaAutosize"],["class","container flex items-center gap-1 py-4",4,"cdkPortal"],[1,"flex","items-end","justify-end","gap-2"],[1,"flex","flex-col","gap-2","mt-2","text-center"],[3,"ngSubmit","reset","formGroup"],[1,"w-full"],["matInput","","type","text","formControlName","title"],["matSuffix","","mat-icon-button","",3,"matTooltip"],["matInput","","cdkTextareaAutosize","","formControlName","body",3,"placeholder"],[1,"flex","justify-center","gap-2"],["mat-button","","color","primary","type","reset",3,"disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["mat-button","","color","accent",3,"deleted","appPostDelete"],["matSuffix","","mat-icon-button","",3,"click","matTooltip"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","fontIcon","error"],["aria-hidden","false","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["mat-button","","color","primary",3,"routerLink"],["aria-hidden","false","fontIcon","chevron_right"]],template:function(l,_){l&1&&(x(0,Gt,30,27),x(1,Qt,6,4,"mat-card"),x(2,jt,7,6,"mat-card"),R(3,Ht,6,9,"div",1)),l&2&&(C(_.dataSource.state()==="loading"||_.dataSource.state()==="data"?0:-1),i(),C(_.dataSource.state()==="error"?1:-1),i(),C(_.dataSource.state()==="empty"?2:-1))},dependencies:[X,it,ft,pt,lt,dt,st,mt,ct,W,H,q,j,Q,Bt,wt,Tt,Dt,It,Et,xt,_t,St,vt,rt,ot,nt,bt,$,U,w,Pt,et,Z],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0});let t=s;return t})();export{ke as PostEditComponent};
